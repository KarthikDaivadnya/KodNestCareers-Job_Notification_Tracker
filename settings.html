<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings — KodNest Careers</title>
  <link rel="stylesheet" href="/app.css" />
</head>
<body class="app-body">

  <div id="nav-root"></div>

  <main class="app-main">
    <div class="app-page">

      <div class="page-header">
        <span class="page-overline">Job Notification Tracker</span>
        <h1 class="page-title">Settings</h1>
        <p class="page-desc">Define your tracking preferences. These drive your match scores and daily digest.</p>
      </div>

      <div class="settings-layout">

        <!-- Sidebar -->
        <aside class="settings-sidebar">
          <h2 class="settings-sidebar-title">Tracking Preferences</h2>
          <p class="settings-sidebar-desc">Set once. Your preferences power the match score engine — every job on your dashboard is scored against these settings.</p>
        </aside>

        <!-- Form -->
        <div class="settings-form">

          <!-- Role Keywords -->
          <div class="form-group">
            <label class="form-label" for="role-keywords">Role Keywords</label>
            <input class="form-input" type="text" id="role-keywords"
              placeholder="e.g. React Developer, Frontend Engineer, SDE Intern" autocomplete="off" />
            <p class="form-hint">Comma-separated. Matched against job title (+25) and description (+15) for scoring.</p>
          </div>

          <!-- Preferred Locations -->
          <div class="form-group">
            <label class="form-label">Preferred Locations</label>
            <div class="form-checkbox-grid">
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Bangalore"> Bangalore</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Hyderabad"> Hyderabad</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Chennai"> Chennai</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Mumbai"> Mumbai</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Pune"> Pune</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Noida"> Noida</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Gurgaon"> Gurgaon</label>
              <label class="form-check-label"><input type="checkbox" class="loc-check" value="Mysuru"> Mysuru</label>
            </div>
            <p class="form-hint">Select all cities you are open to. Jobs matching your selection score +15.</p>
          </div>

          <!-- Work Mode -->
          <div class="form-group">
            <label class="form-label">Work Mode</label>
            <div class="form-checkbox-row">
              <label class="form-check-label"><input type="checkbox" class="mode-check" value="Remote"> Remote</label>
              <label class="form-check-label"><input type="checkbox" class="mode-check" value="Hybrid"> Hybrid</label>
              <label class="form-check-label"><input type="checkbox" class="mode-check" value="Onsite"> Onsite</label>
            </div>
            <p class="form-hint">Select one or more preferred work arrangements. Jobs matching score +10.</p>
          </div>

          <!-- Experience Level -->
          <div class="form-group">
            <label class="form-label" for="experience">Experience Level</label>
            <div class="form-select-wrapper">
              <select class="form-select" id="experience">
                <option value="">Select your experience level</option>
                <option value="Fresher">Fresher (0 years)</option>
                <option value="0-1">0–1 year</option>
                <option value="1-3">1–3 years</option>
                <option value="3-5">3–5 years</option>
              </select>
            </div>
            <p class="form-hint">Exact match with job's experience field scores +10.</p>
          </div>

          <!-- Skills -->
          <div class="form-group">
            <label class="form-label" for="skills">Your Skills</label>
            <input class="form-input" type="text" id="skills"
              placeholder="e.g. React, JavaScript, TypeScript, Node.js" autocomplete="off" />
            <p class="form-hint">Comma-separated. Any overlap with a job's required skills scores +15.</p>
          </div>

          <!-- Min Match Score -->
          <div class="form-group">
            <label class="form-label" for="min-score">Minimum Match Score Threshold</label>
            <div class="form-slider-wrap">
              <input type="range" class="form-slider" id="min-score" min="0" max="100" value="40" />
              <div class="form-slider-meta">
                <span>0</span>
                <span class="form-slider-value">Threshold: <strong id="score-display">40</strong></span>
                <span>100</span>
              </div>
            </div>
            <p class="form-hint">When the "Show only matches" toggle is on, only jobs at or above this score appear.</p>
          </div>

          <!-- Footer -->
          <div class="form-footer">
            <div>
              <span class="settings-save-success" id="save-success">
                ✓ Preferences saved. Your dashboard will reflect these settings.
              </span>
              <span class="form-footer-note" id="save-note">Preferences are stored locally. No data leaves your browser.</span>
            </div>
            <button type="button" id="save-btn" onclick="savePreferences()"
              style="display:inline-flex;align-items:center;height:44px;padding:0 32px;background-color:#8B0000;color:#F7F6F3;font-family:'Inter',sans-serif;font-size:13px;font-weight:500;letter-spacing:0.06em;text-transform:uppercase;border:1px solid #8B0000;border-radius:8px;cursor:pointer;transition:background-color 150ms ease-in-out;white-space:nowrap;">
              Save Preferences
            </button>
          </div>

        </div>
      </div>

    </div>
  </main>

  <script src="/match-engine.js"></script>
  <script>
    var ME = window.MATCH_ENGINE;

    /* ── Slider live update ── */
    document.getElementById('min-score').addEventListener('input', function () {
      document.getElementById('score-display').textContent = this.value;
    });

    /* ── Save ── */
    function savePreferences() {
      var prefs = {
        roleKeywords: document.getElementById('role-keywords').value.trim(),
        preferredLocations: Array.from(document.querySelectorAll('.loc-check:checked')).map(function (cb) { return cb.value; }),
        preferredMode: Array.from(document.querySelectorAll('.mode-check:checked')).map(function (cb) { return cb.value; }),
        experienceLevel: document.getElementById('experience').value,
        skills: document.getElementById('skills').value.trim(),
        minMatchScore: parseInt(document.getElementById('min-score').value, 10)
      };

      ME.savePreferences(prefs);

      /* Success feedback */
      var noteEl = document.getElementById('save-note');
      var successEl = document.getElementById('save-success');
      noteEl.style.display = 'none';
      successEl.classList.add('is-visible');
      setTimeout(function () {
        successEl.classList.remove('is-visible');
        noteEl.style.display = '';
      }, 3000);
    }

    /* ── Prefill on load ── */
    function prefill() {
      var prefs = ME.getPreferences();
      if (!prefs) return;

      if (prefs.roleKeywords) document.getElementById('role-keywords').value = prefs.roleKeywords;
      if (prefs.skills)       document.getElementById('skills').value       = prefs.skills;
      if (prefs.experienceLevel) document.getElementById('experience').value = prefs.experienceLevel;
      if (prefs.minMatchScore !== undefined) {
        document.getElementById('min-score').value = prefs.minMatchScore;
        document.getElementById('score-display').textContent = prefs.minMatchScore;
      }
      if (prefs.preferredLocations) {
        prefs.preferredLocations.forEach(function (loc) {
          var cb = document.querySelector('.loc-check[value="' + loc + '"]');
          if (cb) cb.checked = true;
        });
      }
      if (prefs.preferredMode) {
        prefs.preferredMode.forEach(function (m) {
          var cb = document.querySelector('.mode-check[value="' + m + '"]');
          if (cb) cb.checked = true;
        });
      }
    }

    document.addEventListener('DOMContentLoaded', prefill);
  </script>

  <script src="/app-nav.js"></script>
</body>
</html>
